#!/usr/bin/env bash
set -euo pipefail

version=$(<VERSION)
version=$(echo "$version" | xargs) # Trim whitespace

echo "ğŸ”¨ Building docker image for release of Buildkite Builder version $version"
docker build --tag=gusto/buildkite-builder:"$version" \
  --platform linux/x86_64 \
  --build-arg version="$version" .

echo "ğŸ“¦ Pushing to DockerHub: gusto/buildkite-builder:$version"
docker push gusto/buildkite-builder:"$version"

echo "âœ… Done!"
